<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# 디렉터리 4: Delivery Stack (Backend · Frontend · DevOps) (/04_delivery_stack)

“API, 프론트, 배포/운영으로 실제 사용자에게 가는 경로.”
4-1. 백엔드(FastAPI) \& 통합
fastapi-architecture.md
모듈/레이어 구조(라우터, 서비스, 리포지토리, 스키마)
도메인별 API 설계(워크플로우/실행/로그/통합 등)
langgraph-backend-integration.md
LangGraph 실행을 위한 엔드포인트 패턴(sync/async)
백그라운드 작업/큐 사용 여부, 체크포인트/재실행 설계
external-integrations.md
ESP, Slack, Stripe, CRM 연동 패턴
공통 통합 모듈, 에러 핸들링, 재시도·멱등성
4-2. 프론트엔드(Next.js PWA)
nextjs-architecture.md
app router 구조, layout/route group, 국제화/SEO/PWA
state-and-data-fetching.md
RSC vs Client Component 전략
TanStack Query/SWR 페치 패턴, 캐싱·에러 처리
workflow-editor-ui.md
노드 그래프 UI, 드래그·줌·연결 인터랙션
속성 패널, 실행 로그/상태 표시 UI
4-3. DevOps · CI/CD · Monorepo
monorepo-structure-and-env.md
apps/(web/api/worker), packages/(ui/core/llm/rag), infra/ 구조
env/secret 관리(.env, Vault, CI secrets), 환경별 설정
ci-cd-pipelines.md
빌드/테스트/배포 파이프라인(프론트·백 분리, 캐시 전략)
Dev/Stage/Prod, Canary/Blue-Green, 롤백 정책
deployment-and-cost-optimization.md
인프라 as Code, 리소스 스케일링
LLM·스토리지·트래픽 비용 모니터링 및 최적화

**각 .md 파일의 세부 섹션/문단 수준까지 더 쪼개는 “세분화 작업”**

디렉터리 4의 각 `.md`를 바로 작성 가능한 수준으로 **섹션/소제목 단위까지 세분화**한 구조입니다.[^1][^2][^3]

***

## 4-1. 백엔드(FastAPI) \& 통합

### 1) `fastapi-architecture.md`

#### 1. 서론

- 1.1 문서의 목적
- 1.2 범위(도메인 API, 구조, 관례)


#### 2. FastAPI 프로젝트 구조 개요

- 2.1 루트 구조 예시(`app/`, `tests/`, `alembic/` 등)
- 2.2 모듈 네임스페이스 규칙


#### 3. 레이어드 아키텍처

- 3.1 라우터 레이어 (API 엔드포인트)
- 3.2 서비스 레이어 (비즈니스 로직)
- 3.3 리포지토리 레이어 (DB/RAG 접근)
- 3.4 스키마 레이어 (Pydantic 모델)


#### 4. 도메인별 API 설계

- 4.1 Auth/Workspace/User API
- 4.2 Workflow/Node/Execution/Log API
- 4.3 Integration/ESP/Payment API


#### 5. 공통 컴포넌트

- 5.1 에러 핸들러·응답 포맷 규약
- 5.2 의존성 주입(DI) 패턴
- 5.3 미들웨어(로깅·CORS·트레이싱)


#### 6. 보안·권한

- 6.1 인증(JWT/Supabase Auth 등)
- 6.2 워크스페이스/역할 기반 권한


#### 7. 체크리스트


***

### 2) `langgraph-backend-integration.md`

#### 1. 서론

- 1.1 LangGraph를 백엔드에서 어떻게 노출할 것인가


#### 2. LangGraph 실행 모델

- 2.1 그래프 정의 위치·로딩 방식
- 2.2 동기 실행 vs 비동기 실행 개념[^4]


#### 3. 엔드포인트 패턴

- 3.1 단일 호출형(graph.run) API 패턴
- 3.2 장기 실행/스트리밍/상태 질의형 API 패턴
- 3.3 요청 스키마(입력 상태)/응답 스키마(최종 상태)


#### 4. 백그라운드 작업·큐 설계

- 4.1 큐/워커 사용 여부(Celery, RQ 등)
- 4.2 대용량/장기 작업 처리 패턴
- 4.3 재시도·지연·우선순위 전략


#### 5. 체크포인트·재실행

- 5.1 LangGraph 체크포인트 스토어 설계[^5]
- 5.2 중단/실패 시 재실행 전략
- 5.3 실행 ID·상태 조회 API 설계


#### 6. 관찰성

- 6.1 각 그래프 실행의 로그·메트릭·트레이스를 어떻게 남길 것인가


#### 7. 체크리스트


***

### 3) `external-integrations.md`

#### 1. 서론

- 1.1 통합(ESP/Slack/Stripe/CRM)의 역할과 범위


#### 2. 통합 아키텍처 원칙

- 2.1 공통 통합 모듈 vs 개별 서비스 모듈
- 2.2 API 클라이언트 추상화·인터페이스 설계


#### 3. ESP 통합

- 3.1 메일 발송·템플릿·세그먼트 관리 패턴
- 3.2 Webhook(이벤트) 수신 및 워크플로우 연계


#### 4. Slack/Chat 통합

- 4.1 알림 메세지 구조
- 4.2 Slash command/Interaction 처리 패턴


#### 5. Stripe/결제 통합

- 5.1 결제·구독·플랜 변경 플로우
- 5.2 결제 Webhook과 권한/플랜 동기화


#### 6. CRM/기타 SaaS 통합

- 6.1 공통 인터페이스(Lead, Account, Event 등)
- 6.2 레이트리밋·쿼터 고려


#### 7. 에러 핸들링·재시도·멱등성

- 7.1 외부 API 실패 패턴 및 재시도 설계
- 7.2 멱등성 키·중복 방지 전략


#### 8. 체크리스트


***

## 4-2. 프론트엔드(Next.js PWA)

### 4) `nextjs-architecture.md`

#### 1. 서론

- 1.1 프론트엔드 아키텍처 문서 목표


#### 2. 앱 구조 개요

- 2.1 `app/` 디렉터리 구조 (route group, segment)
- 2.2 레이아웃 구조(root layout, workspace layout 등)


#### 3. 라우팅 전략

- 3.1 공개/인증/관리자 라우트 구분
- 3.2 워크스페이스/프로젝트/워크플로우별 URL 패턴


#### 4. 국제화·SEO·PWA

- 4.1 Next.js i18n 라우팅, 언어 스위치 UX
- 4.2 SEO 전략(메타 태그, OG, sitemap)
- 4.3 PWA 설정(Manifest, Service Worker, 오프라인 정책)


#### 5. 성능·번들링

- 5.1 코드 스플리팅·lazy loading 전략
- 5.2 이미지 최적화·폰트·캐시 정책


#### 6. 체크리스트


***

### 5) `state-and-data-fetching.md`

#### 1. 서론

#### 2. RSC vs Client Component 전략

- 2.1 RSC 사용 대상(데이터 주도 UI)
- 2.2 클라이언트 컴포넌트 사용 대상(인터랙션/상태)[^2]


#### 3. 데이터 패칭 계층

- 3.1 서버 데이터 패칭(React Server Components)
- 3.2 클라이언트 데이터 패칭(TanStack Query/SWR)
- 3.3 에러/로딩/빈 상태 처리 패턴


#### 4. 캐싱 전략

- 4.1 정적/동적 캐싱 구분
- 4.2 워크플로우·실행 로그·설정 데이터 캐시 수명


#### 5. 상태 관리

- 5.1 폼/로컬 UI 상태 관리
- 5.2 전역 상태(선택된 워크플로우, 편집 상태 등) 관리 정책


#### 6. 체크리스트


***

### 6) `workflow-editor-ui.md`

#### 1. 서론

- 1.1 워크플로우 에디터의 역할


#### 2. 레이아웃 구조

- 2.1 캔버스 영역
- 2.2 노드 목록/팔레트
- 2.3 속성 패널(노드 설정)
- 2.4 실행 로그/상태 패널
- 2.5 버전/히스토리 패널


#### 3. 그래프 인터랙션 패턴

- 3.1 노드 추가/삭제/이동
- 3.2 드래그·줌·팬
- 3.3 연결 생성/삭제/편집


#### 4. 속성 편집 UX

- 4.1 폼·검증·에러 피드백 패턴
- 4.2 자격 증명 선택/연결 UX


#### 5. 실행 상태 표시 UI

- 5.1 마지막 실행 결과 하이라이트
- 5.2 노드별 실행 상태(성공/실패/스킵) 표시
- 5.3 디버깅·재실행 트리거 버튼


#### 6. 컴포넌트·디자인 시스템 매핑

- 6.1 shadcn/ui 컴포넌트 매핑
- 6.2 Tailwind 유틸리티 규칙


#### 7. 체크리스트


***

## 4-3. DevOps · CI/CD · Monorepo

### 7) `monorepo-structure-and-env.md`

#### 1. 서론

#### 2. Monorepo 구조

- 2.1 `apps/` (web/api/worker 등)
- 2.2 `packages/` (ui/core/llm/rag/workflows)
- 2.3 `infra/` (IaC, 환경 구성)[^3][^2]


#### 3. 코드 소유권·경계

- 3.1 팀/도메인별 소유권 매핑
- 3.2 변경 영향도 최소화 전략


#### 4. 환경·시크릿 관리

- 4.1 `.env` 정책(로컬 전용, 커밋 금지)
- 4.2 Vault/Secret Manager 사용 전략
- 4.3 환경별(Dev/Stage/Prod) 설정 분리


#### 5. 구성 관리

- 5.1 공통 설정 패키지(config)
- 5.2 Feature flag·실험 플래그 관리


#### 6. 체크리스트


***

### 8) `ci-cd-pipelines.md`

#### 1. 서론

#### 2. 빌드 파이프라인

- 2.1 프론트/백 분리 빌드 전략
- 2.2 캐시 활용(의존성/빌드 캐시)


#### 3. 테스트 파이프라인

- 3.1 단위 테스트/통합 테스트/엔드투엔드 테스트 단계
- 3.2 최소 커버리지 기준


#### 4. 배포 파이프라인

- 4.1 Dev/Stage/Prod 단계 구성
- 4.2 자동/수동 승인 단계
- 4.3 Canary/Blue-Green 배포 정책


#### 5. 롤백 전략

- 5.1 롤백 트리거 조건
- 5.2 롤백 절차·툴


#### 6. 관찰성 연계

- 6.1 배포 이벤트와 모니터링/알람 연동


#### 7. 체크리스트


***

### 9) `deployment-and-cost-optimization.md`

#### 1. 서론

#### 2. 인프라 as Code

- 2.1 IaC 도구 선택(Terraform/Pulumi 등)
- 2.2 환경별 스택 정의 원칙


#### 3. 리소스 스케일링

- 3.1 수평/수직 스케일 기준
- 3.2 워크플로우 실행·LLM 호출량 기반 스케일링


#### 4. 비용 모니터링

- 4.1 LLM 비용(호출 수, 토큰, 모델별 단가)
- 4.2 스토리지·네트워크·컴퓨트 비용


#### 5. 비용 최적화 전략

- 5.1 캐싱·저비용 모델·배치 처리 활용
- 5.2 비활성 리소스 정리·자동 파킹


#### 6. 체크리스트


***

이 구조를 그대로 `/04_delivery_stack` 내 `.md` 파일의 헤더로 쓰면, 이후에는 각 섹션에 **구체 설명·표·코드/설정 예시·프롬프트 예시**를 채워 넣는 작업만 진행하면 됩니다.[^1][^2][^3]

<div align="center">⁂</div>

[^1]: https://forum.cursor.com/t/best-practices-for-structuring-a-next-js-fastapi-supabase-project/49706

[^2]: https://www.pronextjs.dev/workshops/next-js-react-server-component-rsc-architecture-jbvxk/understanding-the-example-monorepo-structure-4gpny

[^3]: https://github.com/belgattitude/nextjs-monorepo-example/blob/main/README.md

[^4]: https://www.langchain.com/langgraph

[^5]: https://www.swarnendu.de/blog/langgraph-best-practices/

